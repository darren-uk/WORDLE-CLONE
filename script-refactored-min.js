const NUMBER_OF_GUESSES=6,green="rgb(106, 170, 100)",yellow="rgb(201, 180, 88)";let allWords,commonWords,answer,gameActive=!1,guessesRemaining=6,nextLetter=0,currentGuess=[],statContainer=document.getElementById("stat-container"),coloredKeys=document.querySelectorAll(".keyboard-button");function startGame(){guessesRemaining=6,currentGuess=[],nextLetter=0,answer=commonWords[Math.floor(Math.random()*commonWords.length)],initBoard(),gameActive=!0}function initBoard(){let e=document.getElementById("game-board");e.innerHTML="";for(let t=0;t<6;t++){let t=document.createElement("div");t.className="letter-row";for(let e=0;e<5;e++){let e=document.createElement("div");e.className="letter-box",t.appendChild(e)}e.appendChild(t)}}function endGame(){gameActive=!1,coloredKeys.forEach((e=>{e.classList.contains("red-text")||e.classList.contains("green-text")?e.style.backgroundColor="var(--action-key-background)":(e.style.backgroundColor="var(--key-background)",e.classList.remove("light-text"))}))}function checkGuess(){let e=document.getElementsByClassName("letter-row")[6-guessesRemaining],t="",n=Array.from(answer);for(const e of currentGuess)t+=e;if(5==t.length){if(allWords.includes(t)){for(let t=0;t<5;t++){let a="",s=e.children[t],r=currentGuess[t],o=n.indexOf(currentGuess[t]);-1===o?a="var(--letter-box-filled)":(a=currentGuess[t]===n[t]?green:yellow,n[o]="#"),setTimeout((()=>{applyAnimation(s,"flipInX"),s.style.backgroundColor=a,shadeKeyBoard(r,a),s.classList.add("light-text")}),250*t)}return t===answer?(toastr.success("You guessed right! Game over!"),guessesRemaining=0,winner(),statsPanel(),void setTimeout((()=>{statContainer.classList.remove("back"),statContainer.classList.add("forward")}),"1500")):(guessesRemaining-=1,currentGuess=[],nextLetter=0,0===guessesRemaining?(toastr.error("You've run out of guesses! Game over!"),toastr.info(`The right word was: "${answer}"`),loser(),statsPanel(),void setTimeout((()=>{statContainer.classList.remove("back"),statContainer.classList.add("forward")}),"1500")):void 0)}toastr.error("Word not in list!")}else toastr.error("Not enough letters!")}function statsPanel(){let e=localStorage.getItem("wins"),t=localStorage.getItem("loses"),n=localStorage.getItem("max-streak"),a=localStorage.getItem("current-streak"),s=Number(e)+Number(t);null==e&&(e=0),null==t&&(t=0),null==n&&(n=0),null==a&&(a=0);let r=Math.round(Number(e)/s*100);isNaN(r)&&(r=0),statContainer.innerHTML=`\n            <div class="statscreen">\n                <div class="close-box" id="close-box">X</div>\n                <h2>Wordle <span>Unlimited</span></h2>\n                <p class="start-line">Want to try again? <button class="start-button" id="stat-start-button">Start New Game</button></p>\n                <hr>\n                <p>Win % = ${r}</p>\n                <p>Games played = ${s}</p>\n                <p>Games won = ${e}</P>\n                <p>Games Lost = ${t}</p>\n\n                <p>Current streak = ${a}</p>\n                <p>Max streak = ${n}</p>\n                <hr>\n                <p><img src="./images/triangle-exclamation-solid.svg" class="warning-icon"><button class="reset-button" id="reset-button">Reset Stats</button><img src="./images/triangle-exclamation-solid.svg" class="warning-icon"></p>\n            </div>`;document.getElementById("close-box").addEventListener("click",(()=>{statContainer.classList.remove("forward"),statContainer.classList.add("back")}));document.getElementById("stat-start-button").addEventListener("click",(()=>{statContainer.classList.remove("forward"),statContainer.classList.add("back"),endGame(),startGame()}));document.querySelector("#reset-button").addEventListener("click",(()=>{confirm("Press OK to confirm delete of all data")&&(localStorage.removeItem("wins"),localStorage.removeItem("loses"),localStorage.setItem("current-streak",0),statsPanel())}))}function winner(){let e=localStorage.getItem("wins");e||(e=0),e=+e+1,localStorage.setItem("wins",e),setCurrentStreak()}function loser(){let e=localStorage.getItem("loses");e||(e=0),e=+e+1,localStorage.setItem("loses",e),localStorage.setItem("current-streak",0)}function setCurrentStreak(){let e=localStorage.getItem("current-streak");e||(e=0),e=+e+1,localStorage.setItem("current-streak",e);let t=localStorage.getItem("max-streak");(!t||t<e)&&localStorage.setItem("max-streak",e)}function insertLetter(e){if(!gameActive||5===nextLetter)return;let t=document.getElementsByClassName("letter-row")[6-guessesRemaining].children[nextLetter];applyAnimation(t,"pulse"),t.textContent=e,t.classList.add("filled-box"),currentGuess.push(e),nextLetter+=1}function deleteLetter(){let e=document.getElementsByClassName("letter-row")[6-guessesRemaining].children[nextLetter-1];e.textContent="",e.classList.remove("filled-box"),currentGuess.pop(),nextLetter-=1}function shadeKeyBoard(e,t){for(const n of document.getElementsByClassName("keyboard-button"))if(n.textContent===e){let e=n.style.backgroundColor;if(e===green||e===yellow&&t!==green)return;n.style.backgroundColor=t,n.classList.add("light-text");break}}function applyAnimation(e,t,n="0.3s"){e.style.animation=`${t} ${n}`,e.addEventListener("animationend",(()=>{e.style.animation=""}))}function handleKeyboardClick(e){const t=e.target;if(!t.classList.contains("keyboard-button"))return;let n=t.textContent;"Del"===n&&(n="Backspace"),document.dispatchEvent(new KeyboardEvent("keyup",{key:n}))}function handleKeyUp(e){if(0===guessesRemaining)return;let t=String(e.key);if("Backspace"===t&&0!==nextLetter)return void deleteLetter();if("Enter"===t)return void checkGuess();let n=t.match(/[a-z]/gi);n&&1===n.length&&insertLetter(t)}function handleStatButtonClick(){statContainer.classList.remove("back"),statContainer.classList.add("forward")}function handleStartButtonClick(){statContainer.classList.remove("forward"),statContainer.classList.add("back"),endGame(),startGame()}statsPanel(),document.getElementById("keyboard-cont").addEventListener("click",handleKeyboardClick),document.addEventListener("keyup",handleKeyUp);const statButton=document.querySelector("#stat-button");statButton.addEventListener("click",handleStatButtonClick);let startButton=document.getElementById("start-button");startButton&&startButton.addEventListener("click",handleStartButtonClick);const toggleSwitch=document.querySelector('.theme-switch input[type="checkbox"]');function switchTheme(e){e.target.checked?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light"))}toggleSwitch.addEventListener("change",switchTheme,!1);const currentTheme=localStorage.getItem("theme")?localStorage.getItem("theme"):null;currentTheme&&(document.documentElement.setAttribute("data-theme",currentTheme),"dark"===currentTheme&&(toggleSwitch.checked=!0)),fetch("words.json").then((e=>e.json())).then((e=>{allWords=e.all,commonWords=e.common})).catch((e=>{document.querySelector("#error-box").innerText="Please try again later (error connecting with our server)"}));